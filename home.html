<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Điểm tin </title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }
    .container {
      max-width: 800px;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }
    .header h2 {
      margin: 0;
      font-size: 24px;
      color: #333;
    }
    .controls {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    .controls label {
      font-weight: bold;
      color: #555;
    }
    .controls select {
      padding: 6px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 3px;
    }
    .btn {
      padding: 6px 12px;
      font-size: 14px;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      background-color: #007BFF;
      color: #fff;
      transition: background-color 0.3s ease;
    }
    .btn:hover {
      background-color: #0056b3;
    }
    .news-item {
      border-bottom: 1px solid #ddd;
      padding: 10px 0;
    }
    .news-item:last-child {
      border-bottom: none;
    }
    .news-item h3 {
      margin: 0 0 5px;
      color: #007BFF;
    }
    .news-item p {
      margin: 0;
      color: #555;
    }
    .loading {
      text-align: center;
      font-size: 16px;
      color: gray;
      margin-top: 20px;
    }
    #back-to-top {
      position: fixed;
      bottom: 30px;
      right: 30px;
      display: none;
      background-color: #007BFF;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      transition: opacity 0.3s ease;
    }
    .news-link {
      cursor: pointer;
    }
  </style>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-W9WTM4SP');</script>
    <!-- End Google Tag Manager -->
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W9WTM4SP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <div class="container">
    <!-- Filter Dropdown -->
    <div class="controls">
      <label for="news-filter">Điểm tin:</label>
      <select id="news-filter">
        <option value="important">Tin mới</option>
        <option value="positive">Tin vui</option>
        <option value="the-gioi">Thế Giới</option>
        <option value="thoi-su">Thời Sự</option>
        <option value="kinh-doanh">Kinh Doanh</option>
        <option value="giai-tri">Giải Trí</option>
        <option value="the-thao">Thể Thao</option>
        <option value="phap-luat">Pháp Luật</option>
        <option value="giao-duc">Giáo Dục</option>
        <option value="suc-khoe">Sức Khỏe</option>
        <option value="gia-dinh">Gia Đình</option>
        <option value="du-lich">Du Lịch</option>
        <option value="cong-nghe">Công Nghệ</option>
        <option value="oto-xe-may">Ôtô Xe Máy</option>
        <option value="y-kien">Ý Kiến</option>
        <option value="tin-khac">Tin Khác</option>
      </select>
    </div>
    
    <div id="news-container"></div>
    <div id="loading" class="loading">Loading more news...</div>
  </div>
  
  <button id="back-to-top">&#8679;</button>

  <script>
    // Replace this with your actual news data.
    const newsData = [{"title":"Mỹ loại Lockheed Martin khỏi cuộc đua máy bay tiêm kích thế hệ mới","content":"Mỹ sẽ loại Lockheed Martin khỏi cuộc đua phát triển máy bay tiêm kích tàng hình thế hệ mới F/A-XX, tập trung vào các thiết kế từ Boeing và Northrop Grumman. Quyết định này được đưa ra do Lockheed Martin không đáp ứng các tiêu chí cần thiết trong cuộc cạnh tranh. Hải quân Mỹ vẫn chưa công bố chính thức về quyết định này và sẽ chọn một nhà thầu duy nhất để phát triển máy bay trong tương lai gần.","link":"https://dantri.com.vn/the-gioi/my-loai-lockheed-martin-khoi-cuoc-dua-may-bay-tiem-kich-the-he-moi-20250305104644012.htm","cat":"quân-su","positivity":4,"importance":8,"question":"Tại sao Mỹ loại Lockheed Martin khỏi cuộc đua phát triển máy bay tiêm kích thế hệ mới?","answers":[{"text":"Bởi vì Lockheed Martin không đáp ứng các tiêu chí cần thiết.","correct":true},{"text":"Vì Hải quân Mỹ muốn phát triển với Boeing và Northrop Grumman.","correct":false},{"text":"Vì giá cả phát triển quá cao.","correct":false},{"text":"Vì Lockheed Martin đã có quá nhiều hợp đồng trước đó.","correct":false}]},{"title":"Bích Đầm trên vịnh Nha Trang trở thành điểm du lịch cộng đồng","content":"Tổ dân phố Bích Đầm, thuộc đảo Hòn Tre, TP Nha Trang, đã chính thức trở thành điểm du lịch cộng đồng. UBND TP Nha Trang phê duyệt đề án phát triển du lịch cộng đồng tại đây, với mục tiêu thu hút 45.000 khách du lịch mỗi năm vào năm 2025 và nâng cao chất lượng dịch vụ du lịch. Các hoạt động du lịch sẽ tập trung vào du lịch sinh thái và trải nghiệm nghề cá, góp phần tạo sinh kế bền vững cho người dân địa phương và bảo tồn đa dạng sinh học biển.","link":"https://tuoitre.vn/bich-dam-tren-vinh-nha-trang-tro-thanh-diem-du-lich-cong-dong-20250305105334629.htm","cat":"du-lich","positivity":9,"importance":8,"question":"Bích Đầm ở Nha Trang vừa trở thành điểm du lịch cộng đồng, đúng không?","answers":[{"text":"Đúng","correct":true},{"text":"Sai","correct":false},{"text":"Chưa xác định","correct":false},{"text":"Không rõ","correct":false},{"text":"Không phải","correct":false}]},{"title":"Chiến sự Ukraine 5/3: Nga tận dụng thời cơ, 2 gọng kìm tràn qua biên giới","content":"Vào ngày 5/3/2025, quân đội Nga đã tận dụng thời cơ từ sự suy yếu của Ukraine để triển khai hai mũi tấn công từ tỉnh Kursk và Belgorod, xâm nhập lãnh thổ Ukraine và kiểm soát một số ngôi làng. Trong khi đó, lực lượng Ukraine đã phải đối mặt với áp lực lớn từ các cuộc tấn công của Nga, đặc biệt ở khu vực Kursk. Báo cáo từ Bộ Tổng tham mưu Ukraine cho biết, quân đội Ukraine đã ngăn chặn nhiều nỗ lực tấn công nhưng vẫn phải chống đỡ trước nhiều cuộc không kích và pháo kích từ phía Nga.","link":"https://dantri.com.vn/the-gioi/chien-su-ukraine-53-nga-tan-dung-thoi-co-2-gong-kim-tran-qua-bien-gioi-20250305115858765.htm","cat":"the-gioi","positivity":3,"importance":8,"question":"Tình hình chiến sự Ukraine ngày 5/3 có diễn biến gì nổi bật?","answers":[{"text":"Nga đã xâm nhập vào lãnh thổ Ukraine từ Kursk và Belgorod.","correct":true},{"text":"Ukraine đã giành chiến thắng lớn trước Nga.","correct":false},{"text":"Nga đã ngừng mọi hoạt động quân sự.","correct":false},{"text":"Ukraine đã tấn công mạnh mẽ vào Kursk.","correct":false}]},{"title":"Xử phúc thẩm vụ bà Trương Mỹ Lan và đồng phạm phát hành trái phiếu khống từ ngày 25-3","content":"Tòa án nhân dân cấp cao tại TP.HCM sẽ xử phúc thẩm vụ án của bà Trương Mỹ Lan và 27 đồng phạm từ ngày 25-3 đến 21-4. Họ bị kháng cáo liên quan đến việc phát hành trái phiếu khống, rửa tiền, và vận chuyển trái phép tiền tệ qua biên giới. Trước đó, bà Trương Mỹ Lan đã bị tuyên án chung thân về các tội danh này, trong đó có lừa đảo chiếm đoạt tài sản. Tại phiên tòa, bà sẽ có sự bào chữa của 8 luật sư.","link":"https://tuoitre.vn/xu-phuc-tham-vu-ba-truong-my-lan-va-dong-pham-phat-hanh-trai-phieu-khong-tu-ngay-25-3-20250305120003743.htm","cat":"phap-luat","positivity":3,"importance":8,"question":"Khi nào tòa án sẽ xử phúc thẩm vụ án của bà Trương Mỹ Lan?","answers":[{"text":"Từ ngày 25-3 đến 21-4","correct":true},{"text":"Từ ngày 15-3 đến 10-4","correct":false},{"text":"Từ ngày 1-4 đến 15-4","correct":false},{"text":"Từ ngày 20-3 đến 5-4","correct":false},{"text":"Từ ngày 30-3 đến 15-4","correct":false}]},{"title":"Toàn bộ tay vợt Trung Quốc rút khỏi giải bóng bàn Ấn Độ","content":"Đội tuyển bóng bàn Trung Quốc đã quyết định rút khỏi giải WTT Chennai 2025 với lý do chính thức là để chuẩn bị cho vòng loại của Đại hội thể thao toàn quốc. Mặc dù lý do được đưa ra là hợp lý, nhưng nhiều nghi vấn vẫn tồn tại về việc liệu các tay vợt có thể tham gia giải Ấn Độ hay không, nhất là khi các tay vợt hàng đầu đã sẵn sàng cho vòng loại. Truyền thông cho biết, sự rút lui này cũng có thể liên quan đến các vấn đề về sức khỏe và an toàn thực phẩm tại các sự kiện thể thao ở Ấn Độ trong quá khứ, khiến nhiều nhà tài trợ cũng rút lui theo.","link":"https://vnexpress.net/toan-bo-tay-vot-trung-quoc-rut-khoi-giai-bong-ban-an-do-4856944.html","cat":"the-thao","positivity":3,"importance":7,"question":"Tại sao đội tuyển bóng bàn Trung Quốc rút khỏi giải WTT Chennai 2025?","answers":[{"text":"Để chuẩn bị cho Đại hội thể thao toàn quốc.","correct":true},{"text":"Vì lý do tài chính.","correct":false},{"text":"Do thời tiết không thuận lợi.","correct":false},{"text":"Để tham gia giải đấu ở Châu Âu.","correct":false}]},{"title":"Vụ nữ sinh cấp 2 bị nhóm học sinh cấp 3 hành hung: Do mâu thuẫn trên mạng","content":"Vụ việc nữ sinh cấp 2 bị nhóm học sinh cấp 3 hành hung ở Ninh Bình xảy ra do mâu thuẫn trên mạng xã hội. Sau khi xảy ra xô xát, nữ sinh lớp 11 cùng bạn đã hành hung nữ sinh lớp 9 bằng mũ bảo hiểm. Hiện tại, các cơ quan chức năng đang điều tra và nhà trường đã yêu cầu học sinh liên quan viết bản tường trình. Nữ sinh lớp 11 đã nhận lỗi và mong muốn có cơ hội sửa chữa sai lầm của mình.","link":"https://dantri.com.vn/giao-duc/vu-nu-sinh-cap-2-bi-nhom-hoc-sinh-cap-3-hanh-hung-do-mau-thuan-tren-mang-20250305114925594.htm","cat":"phap-luat","positivity":3,"importance":7,"question":"Tại sao nữ sinh cấp 2 lại bị hành hung bởi nhóm học sinh cấp 3?","answers":[{"text":"Do mâu thuẫn trên mạng xã hội.","correct":true},{"text":"Do tranh chấp về học tập.","correct":false},{"text":"Do ghen tỵ giữa các bạn học.","correct":false},{"text":"Do hiểu lầm từ trước.","correct":false}]},{"title":"'Ngã ba đánh đố tài xế nếu đi đúng luật'","content":"Bài viết phản ánh về tình trạng giao thông tại ngã ba trên đường tránh quốc lộ 6, nơi có biển chỉ dẫn rẽ trái nhưng lại bị kẻ vạch liền màu vàng không cho phép rẽ. Tình huống này khiến tài xế phải di chuyển xa hơn mới có chỗ quay đầu, trong khi đoạn đường quay đầu lại dốc và hẹp, không đảm bảo an toàn. Tác giả kiến nghị các cơ quan chức năng cần khảo sát và điều chỉnh lại vạch kẻ đường để đảm bảo an toàn giao thông.","link":"https://vnexpress.net/nga-ba-danh-do-tai-xe-neu-di-dung-luat-4856713.html","cat":"phap-luat","positivity":4,"importance":7,"question":"Có vấn đề gì với ngã ba giao thông trên đường tránh quốc lộ 6 không?","answers":[{"text":"Có, vạch kẻ đường và biển chỉ dẫn mâu thuẫn nhau.","correct":true},{"text":"Không có vấn đề gì.","correct":false},{"text":"Đường rất an toàn cho tài xế.","correct":false},{"text":"Tài xế không bị phạt khi rẽ trái.","correct":false}]},{"title":"Bổ sung nước cho Hồ Tây thế nào?","content":"Bài viết đề cập đến dự án bổ sung nước cho Hồ Tây nhằm cải thiện chất lượng nước. Nước từ Nhà máy xử lý nước thải Hồ Tây sẽ được dẫn về hồ Sen để xử lý trước khi bổ cập cho Hồ Tây, với kinh phí dự kiến gần 115 tỷ đồng, thực hiện từ năm 2025 đến 2027. Hồ Sen sẽ được cải tạo thành bãi lọc trồng cây ngập nước để nâng cao chất lượng nước trước khi đưa vào hồ Tây, nhằm duy trì ổn định mực nước và cải thiện môi trường.","link":"https://vnexpress.net/bo-sung-nuoc-cho-ho-tay-the-nao-4856709.html","cat":"thoi-su","positivity":8,"importance":9,"question":"Bổ sung nước cho Hồ Tây được thực hiện như thế nào?","answers":[{"text":"Nước từ Nhà máy xử lý nước thải sẽ được dẫn về hồ Sen để xử lý trước khi bổ sung cho Hồ Tây.","correct":true},{"text":"Nước sẽ được lấy trực tiếp từ sông Hồng mà không cần xử lý.","correct":false},{"text":"Hồ Tây sẽ không bổ sung nước mà sẽ xả ra sông Nhuệ.","correct":false},{"text":"Nước sẽ được đưa từ các hồ nhỏ xung quanh vào Hồ Tây.","correct":false}]},{"title":"Thiếu nữ ngộ độc khí nitơ oxit do hít bóng cười","content":"Nhi, một thiếu nữ 20 tuổi ở TP HCM, đã bị ngộ độc khí nitơ oxit (N2O) do hít bóng cười, dẫn đến mất cảm giác ở tay và không thể tự đi lại. Kết quả xét nghiệm cho thấy nồng độ vitamin B12 bình thường nhưng homocysteine cao gấp 5 lần, chỉ ra tình trạng ngộ độc. Sau 14 ngày điều trị tại bệnh viện, sức khỏe của Nhi đã có tiến triển tốt, với khả năng tự đi lại và phục hồi sức cơ đạt 90%. Các bác sĩ khuyến cáo người trưởng thành nên tránh hít bóng cười để ngăn ngừa nguy cơ ngộ độc khí N2O.","link":"https://vnexpress.net/thieu-nu-ngo-doc-khi-nito-oxit-do-hit-bong-cuoi-4856767.html","cat":"suc-khoe","positivity":7,"importance":8,"question":"Thiếu nữ Nhi đã gặp vấn đề gì do hít bóng cười?","answers":[{"text":"Ngộ độc khí nitơ oxit (N2O)","correct":true},{"text":"Mắc bệnh tim mạch","correct":false},{"text":"Gãy xương tay","correct":false},{"text":"Bị cảm cúm","correct":false},{"text":"Mất ngủ do stress","correct":false}]}];

    const pageSize = 10;       // Number of articles to load each time
    let currentIndex = 0;      // Tracks which batch of items has been loaded
    let isLoading = false;     // Prevents multiple simultaneous loads

    // Set currentFilter to stored value or default to "important"
    let currentFilter = localStorage.getItem("filter") || "important";

    const newsContainer = document.getElementById("news-container");
    const loadingElem = document.getElementById("loading");
    const filterDropdown = document.getElementById("news-filter");
    const backToTopBtn = document.getElementById("back-to-top");

    // Update the dropdown to reflect the stored filter
    filterDropdown.value = currentFilter;

    // Filter news data based on the current filter value.
    function getFilteredNewsData() {
      switch (currentFilter) {
        case "important":
          return newsData.filter(item => item.importance >= 8);
        case "positive":
          return newsData.filter(item => item.positivity >= 8);
        // For category filters, match item.cat exactly
        case "the-gioi":
        case "thoi-su":
        case "kinh-doanh":
        case "giai-tri":
        case "the-thao":
        case "phap-luat":
        case "giao-duc":
        case "suc-khoe":
        case "gia-dinh":
        case "du-lich":
        case "cong-nghe":
        case "oto-xe-may":
        case "y-kien":
          return newsData.filter(item => item.cat === currentFilter);
        case "tin-khac":
          return newsData.filter(item => 
            !['the-gioi', 'thoi-su', 'kinh-doanh', 'giai-tri', 'the-thao', 
             'phap-luat', 'giao-duc', 'suc-khoe', 'gia-dinh', 'du-lich', 
             'cong-nghe', 'oto-xe-may', 'y-kien'].includes(item.cat)
          );
        default:
          return newsData;
      }
    }

    // Load and render the next batch of news articles.
    function loadMoreNews() {
      if (isLoading) return;
      isLoading = true;
      loadingElem.style.display = "block";

      setTimeout(() => {
        const filteredNews = getFilteredNewsData();
        const nextBatch = filteredNews.slice(currentIndex, currentIndex + pageSize);

        if (filteredNews.length === 0 && currentIndex === 0) {
          newsContainer.innerHTML = "<p>No articles match your filter.</p>";
          loadingElem.style.display = "none";
          window.removeEventListener("scroll", handleScroll);
          isLoading = false;
          return;
        }

        nextBatch.forEach(item => {
          const newsItem = document.createElement("div");
          const newsId = convertVietnameseToEnglish(`'${item.title}'`);
          newsItem.classList.add("news-item");
          newsItem.innerHTML = `
            <h3 id='${newsId}'>${item.title}</h3>
            <a class="news-link" href="#${newsId}" onclick="openNewTab('${item.link}')">${item.link}</a>
            <p>${item.content}</p>
          `;
          newsContainer.appendChild(newsItem);
        });

        currentIndex += pageSize;
        isLoading = false;

        if (currentIndex >= filteredNews.length) {
          loadingElem.style.display = "none";
          window.removeEventListener("scroll", handleScroll);
        }
      }, 500); // Simulated loading delay
    }

    // Handle scroll events for infinite scrolling and back-to-top visibility.
    function handleScroll() {
      if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 200) {
        pushDataLayer({event: 'load_more_news'});
        loadMoreNews();
      }
      // Show the back-to-top button after scrolling down 300px
      backToTopBtn.style.display = window.scrollY > 300 ? "block" : "none";
    }

    // Reset and reload news when the filter is changed.
    function onFilterChange() {
      currentFilter = filterDropdown.value;
      localStorage.setItem("filter", currentFilter);
      pushDataLayer({event: 'filter_changed_' + currentFilter});
      currentIndex = 0;
      newsContainer.innerHTML = "";
      loadingElem.style.display = "block";
      window.addEventListener("scroll", handleScroll);
      loadMoreNews();
    }

    // Smooth scroll back to the top of the page.
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
      pushDataLayer({event: 'scroll_to_top'});
    }

    function pushDataLayer(data) {
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push(data);
    }

    function openNewTab(link) {
        pushDataLayer({event: 'view_details'});
        window.open(link, '_self');
    }

    function convertVietnameseToEnglish(str) {
      // Convert to lowercase for consistency
      str = str.toLowerCase();

      // Normalize the string to separate diacritics from letters
      str = str.normalize('NFD');

      // Remove diacritical marks
      str = str.replace(/[\u0300-\u036f]/g, '');

      // Replace Vietnamese specific characters not handled by normalization
      str = str.replace(/đ/g, 'd');

      // Remove any remaining non-alphanumeric characters except spaces and hyphens
      str = str.replace(/[^a-z0-9\s-]/g, '');

      // Replace spaces (and consecutive spaces) with a single hyphen and trim extra hyphens
      return str.trim().replace(/\s+/g, '-');
    }

    // Initial load
    loadMoreNews();
    window.addEventListener("scroll", handleScroll);

    // Listen for filter changes, refresh clicks, and back-to-top clicks.
    filterDropdown.addEventListener("change", onFilterChange);
    backToTopBtn.addEventListener("click", scrollToTop);
  </script>
</body>
</html>